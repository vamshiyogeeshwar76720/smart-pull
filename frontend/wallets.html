<!DOCTYPE html>
<html>

<head>
    <title>Connected Wallets</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>


    <button class="home-btn back-btn" onclick="goBack()">Back</button>
    <h1>Connected Wallets History</h1>

    <table border="1" cellpadding="10">
        <thead>
            <tr>
                <th>Wallet Address</th>
                <th>Date</th>
                <th>Time</th>
            </tr>
        </thead>
        <tbody id="walletTable"></tbody>
    </table>

    <!-- Modal Dialog -->
    <div id="walletModal" style="display: none;">
        <div>
            <h2>Wallet Details</h2>
            <p><b>Wallet Address:</b> <span id="walletAddress"></span></p>
            <p><b>Date:</b> <span id="walletDate"></span></p>
            <p><b>Time:</b> <span id="walletTime"></span></p>
            <button id="modifyBtn">Modify</button>
            <button id="deleteBtn">Delete</button>
            <button id="closeModalBtn">Close</button>
        </div>
    </div>

    <script>
        function goBack() {
            window.location.href = "./main.html";
        }
    </script>


    <script>
        const list = JSON.parse(localStorage.getItem("walletHistory") || "[]");
        const table = document.getElementById("walletTable");

        table.innerHTML = '';

        list.forEach(entry => {
            table.innerHTML += `
                <tr>
                    <td>${entry.address}</td>
                    <td>${entry.date}</td>
                    <td>${entry.time}</td>
                </tr>
            `;
        });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const table = document.getElementById("walletTable");
            let list = JSON.parse(localStorage.getItem("walletHistory") || "[]");

            function renderTable() {
                table.innerHTML = "";
                list.forEach((entry, index) => {
                    const row = table.insertRow();
                    row.dataset.index = index;
                    row.innerHTML = `
        <td>${entry.address}</td>
        <td>${entry.date}</td>
        <td>${entry.time}</td>
      `;
                    row.addEventListener("click", function () {
                        const wallet = list[this.dataset.index];
                        document.getElementById("walletAddress").innerText = wallet.address;
                        document.getElementById("walletDate").innerText = wallet.date;
                        document.getElementById("walletTime").innerText = wallet.time;
                        document.getElementById("walletModal").style.display = "block";
                    });
                });
            }

            renderTable();

            // Close modal
            document.getElementById("closeModalBtn").addEventListener("click", () => {
                document.getElementById("walletModal").style.display = "none";
            });

            // Delete wallet
            document.getElementById("deleteBtn").addEventListener("click", () => {
                const addr = document.getElementById("walletAddress").innerText;
                list = list.filter(w => w.address !== addr);
                localStorage.setItem("walletHistory", JSON.stringify(list));
                renderTable();
                document.getElementById("walletModal").style.display = "none";
            });

            // Modify button placeholder
            document.getElementById("modifyBtn").addEventListener("click", () => {
                alert("Modify functionality not implemented yet.");
            });
        });
    </script>

</body>

</html>